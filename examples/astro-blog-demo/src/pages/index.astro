---
import BlogCategoriesSection from '@/components/blog/BlogCategoriesSection';
import FeedPage from '@/components/blog/FeedPage';
import BaseLayout from '@/layouts/BaseLayout.astro';
import { KitchensinkLayout } from '@/layouts/KitchensinkLayout';
import {
  createCustomCategory,
  loadBlogCategoriesServiceConfig,
  loadBlogFeedServiceConfig,
} from '@wix/headless-blog/services';

import './theme.css';

export const prerender = false;

const [blogFeedServiceConfig, blogCategoriesServiceConfig] = await Promise.all([
  loadBlogFeedServiceConfig({
    pageSize: 10,
    sort: [
      {
        fieldName: 'firstPublishedDate',
        order: 'DESC',
      },
    ],
  }),
  loadBlogCategoriesServiceConfig(),
]);

const customCategoriesToPrepend = [
  createCustomCategory({
    label: 'All posts',
    slug: '/',
    description:
      'Discover the latest insights, tutorials, and best practices for building modern web applications with headless components.',
  }),
];
---

<BaseLayout>
  <title>Blog | Wix Headless Components</title>
  <meta
    name="description"
    content="Explore our blog featuring the latest insights on headless components, web development, and modern architecture."
  />

  <KitchensinkLayout>
    <div class="bg-background min-h-screen">
      <div class="mx-auto max-w-6xl px-6 py-12">
        <BlogCategoriesSection
          pathname={Astro.url.pathname}
          categoryPageBaseUrl="/category/"
          blogCategoriesServiceConfig={blogCategoriesServiceConfig}
          customCategoriesToPrepend={customCategoriesToPrepend}
        />
        <FeedPage
          client:load
          blogFeedServiceConfig={blogFeedServiceConfig}
          postPageBaseUrl="/"
          categoryPageBaseUrl="/category/"
          dateLocale="en-US"
        />
      </div>
    </div>
  </KitchensinkLayout>
</BaseLayout>
